<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Reference ESC: the MP2 - Molony Electronic Speed Control (MESC) Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction/INTRODUCTION.html"><strong aria-hidden="true">1.</strong> Introduction to the MESC</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../introduction/FOREWORD.html"><strong aria-hidden="true">1.1.</strong> Foreword</a></li><li class="chapter-item expanded "><a href="../introduction/LICENSE.html"><strong aria-hidden="true">1.2.</strong> License</a></li><li class="chapter-item expanded "><a href="../introduction/FEATURES.html"><strong aria-hidden="true">1.3.</strong> Features</a></li></ol></li><li class="chapter-item expanded "><a href="../operation/INTRODUCTION.html"><strong aria-hidden="true">2.</strong> Theory and Operation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../operation/THEORY.html"><strong aria-hidden="true">2.1.</strong> Theory of operation</a></li><li class="chapter-item expanded "><a href="../operation/CONTROL.html"><strong aria-hidden="true">2.2.</strong> Control loops</a></li><li class="chapter-item expanded "><a href="../operation/PORTING.html"><strong aria-hidden="true">2.3.</strong> Porting to other microprocessors</a></li></ol></li><li class="chapter-item expanded "><a href="../debugging/DEBUGGING.html"><strong aria-hidden="true">3.</strong> Debugging STM32CubeIDE</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../debugging/FIRMWARE_INTRO.html"><strong aria-hidden="true">3.1.</strong> Getting started</a></li></ol></li><li class="chapter-item expanded "><a href="../MP2/INTRO.html" class="active"><strong aria-hidden="true">4.</strong> Reference ESC: the MP2</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Molony Electronic Speed Control (MESC) Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="mesc-reference-esc-the-multi-platform-modular-powerful-mp2-speed-control"><a class="header" href="#mesc-reference-esc-the-multi-platform-modular-powerful-mp2-speed-control">MESC Reference ESC: The Multi-Platform, Modular, Powerful (MP2) Speed Control</a></h1>
<p>The MESC project is migrating away from the original F303 hardware. This is for a few reasons:</p>
<ol>
<li>ST decided to simply stop selling F303s for several years and even in 2023 they are still 3x the price they were in 2020.</li>
<li>The F303 is very much an old MCU, core clock MHz is low. USB peripheral is less good than the F4/L4.</li>
<li>The F3 onboard opamps are a blessing and a curse. They reduce peripheral count, but it is hard to do differential shunt routing. Not an issue at low currents with 5+mohm resistors, but crippling beyond ~100A.</li>
</ol>
<p>The MP2 is a great platform since it allows easy testing with a variety of MCU targets. I can test with F401 and F411 &quot;blackpills&quot; from ebay, or the F405 pill made by Owhite for either the F405 MCU or a 64pin L4 series MCU.</p>
<p>The cost of the MP2 is very low, and the parts easily swappable and cheap to replace. Full boards can be built for about 60$ each for 5 off including a pill, depending on the choice of MOS an caps (perhaps less if you build it with only 6/18MOS and 1/6 capacitors). For that, you get bursts approaching 300A and continuous of ~120A with a 20s battery.
The application of all features required for MESC plus non compulsorary ones like hardware overcurrent and voltage protection, broad range of powers it can cover and the low costs and the open source nature make this an excellent reference board for the project. There are definitely better performing ESCs out there, but they cost many times as much and the design files are not accessible to all.</p>
<p>There are occasionally group orders of parts made in Europe and the US, so it may be possible to get one or two offs SMT populated. The design repo tries to keep a BoM plus alternatives and set of GERBERs that can be easily ordered from your favourite PCB house. </p>
<p>##The MP2 Features</p>
<ul>
<li>Relatively compact design, fitting for ebikes / medium-large electric scooters.</li>
<li>Inexpensive, optimized for low cost assembly by JLCPCB</li>
<li>100-300A operation with 18 FET, bus bars, and cooling</li>
<li>Modular, with easily replaceable modules </li>
<li>Compatible with several open source projects including VESC, EBICS, SmartESC, STM32 Motor Control Workbench and MESC</li>
</ul>
<p>Documentation for <a href="https://github.com/badgineer/MP2-ESC">MP2 project</a>:</p>
<ul>
<li>Gathering motor parameters [<a href="https://github.com/badgineer/MP2-ESC/docs/MOTOR_PARAM.md">LINK</a>]</li>
<li>Pin mappings between MP2 and the F405 pill [<a href="https://github.com/badgineer/MP2-ESC/docs/MP2_F405PILL_PINOUTS.md">LINK</a>]</li>
<li>MP2 assembly, testing and firmware [<a href="https://github.com/badgineer/MP2-ESC/docs/PCB_ASSEMBLY_TESTING.md">LINK</a>]</li>
<li>MP2 bus bar methods [<a href="https://github.com/badgineer/MP2-ESC/docs/HIGHER_AMP_ASSEMBLY.md">LINK</a>]</li>
<li>Some (bad) examples of connecting the MP2 to a motor [<a href="https://github.com/badgineer/MP2-ESC/docs/QS165_MP2_WIRING.md">LINK</a>]</li>
<li>Gallery of enclosures [<a href="https://github.com/badgineer/MP2-ESC/docs/ENCLOSURE_GALLERY.md">LINK</a>]</li>
<li>MESC Firmware on the MP2 -- getting started with STM32CubeIDE [<a href="https://github.com/badgineer/MP2-ESC/docs/FIRMWARE_INTRO.md">LINK</a>]</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../debugging/FIRMWARE_INTRO.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../debugging/FIRMWARE_INTRO.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
